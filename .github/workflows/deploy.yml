name: Uni-App H5 自动部署

# 当推送到 main 分支时触发这个工作流
on:
  push:
    branches: [ "main" ]

# 赋予工作流读写仓库内容的权限，这样才能推送代码
permissions:
  contents: write

jobs:
  deploy:
    # 在最新的 Ubuntu 系统上运行
    runs-on: ubuntu-latest

    steps:
      # 步骤1：把你的代码下载到云端的机器上
      - name: Checkout code
        uses: actions/checkout@v4

      # 步骤2：部署到 gh-pages 分支
      # 注意：此方案要求你每次在本地用 HBuilderX 编译后，将编译产物提交到源码仓库
      # 你需要修改 .gitignore 文件，移除对 unpackage/dist/build/web 的忽略
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: unpackage/dist/build/web   # 指定你的编译输出文件夹
          branch: gh-pages                    # 推送到 gh-pages 分支
          clean: true                          # 部署前先清理 gh-pages 分支的旧文件